#!/usr/bin/python3
from pwn import *
import codecs
import base64

io = process(['nc', '3.110.229.92', ''])

context.log_level = 'DEBUG'

io.recvline().decode('utf-8')

w = io.recvline().decode('utf-8')

if "rot_13" in w:
    s = w[34:]
    d = s.strip()
    e = codecs.encode(d, 'rot_13')
    a=e.decode('utf-8')
    io.sendline(e)

if "decimal" in w:
    s = w[35:]
    m = s.split()
    c = [chr(int(d)) for d in m]
    r = ''.join(c)
    io.sendline(r)

if "base64" in w:
    s = w[34:]
    d = base64.b64decode(s).decode('utf-8')
    io.sendline(d)

io.recvline().decode('utf-8')
io.recvline().decode('utf-8')
io.recvline().decode('utf-8')

o=io.recvline().decode('utf-8')



def decrypt(ciphertext, key):
    text = ''
    key_length = len(key)
    key_pos = 0
    for i in ciphertext:
        if i.isalpha():
            key_char = key[key_pos]
            key_char_value = ord(key_char.upper()) - ord('A')
            if i.isupper():
                text += chr((ord(i) - ord('A') - key_char_value) % 26 + ord('A'))
            else:
                text += chr((ord(i) - ord('a') - key_char_value) % 26 + ord('a'))
            key_pos = (key_pos + 1) % key_length
        else:
            text += i
    return text

ciphertext = 'KOGPC BFVGS'
key = 'DORAEMON'

text = decrypt(ciphertext, key)


io.sendline(text)

io.recvline().decode('utf-8')
io.recvline().decode('utf-8')
io.recvline().decode('utf-8')
io.recvline().decode('utf-8')
io.recvline().decode('utf-8')


msg ="R5A_c4n_b3_3xpl0it3d"
io.sendline('R5A_c4n_b3_3xpl0it3d')
io.interactive()
